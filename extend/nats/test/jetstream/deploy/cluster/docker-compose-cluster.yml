services:
  nats-server1:
    container_name: nats-server1
    image: nats:2.10.16
    entrypoint: /nats-server
    command: "--config /config/nats-server1.conf"
    ports:
      - 4222:4222
      - 8222:8222
    volumes:
      - ./config:/config
      - ./persistent-data/nats-server1/:/data/nats-server/jetstream
    networks:
      nats-cluster-network:
        ipv4_address: 172.25.0.200

  nats-server2:
    container_name: nats-server2
    image: nats:2.10.16
    entrypoint: /nats-server
    command: "--config /config/nats-server2.conf"
    ports:
      - 4223:4222
      - 8223:8222
    volumes:
      - ./config:/config
      - ./persistent-data/nats-server2/:/data/nats-server/jetstream
    networks:
      nats-cluster-network:
        ipv4_address: 172.25.0.201

  nats-server3:
    container_name: nats-server3
    image: nats:2.10.16
    entrypoint: /nats-server
    command: "--config /config/nats-server3.conf"
    ports:
      - 4224:4222
      - 8224:8222
    volumes:
      - ./config:/config
      - ./persistent-data/nats-server3/:/data/nats-server/jetstream
    networks:
      nats-cluster-network:
        ipv4_address: 172.25.0.202

networks:
  nats-cluster-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.25.0.0/24
